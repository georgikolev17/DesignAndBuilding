@using DesignAndBuilding.Web.ViewModels.Assignment
@model EngineerAssignmentsViewModel
@{
    this.ViewData["Title"] = "Моите наддавания";
}
<partial name="_AssignmentsPartial" model="@Model">
@section Scripts
{
        <script>
            $(document).ready(function() {
                const table = $('#assignmentsTable').DataTable({
                    language: {
                        lengthMenu: "Покажи _MENU_ записа",
                        search: "Търси:",
                        info: "Показани _START_ до _END_ от общо _TOTAL_ записа",
                        infoFiltered: "(филтрирано от общо _MAX_ записа)",
                        infoEmpty: "Няма налични записи",
                        zeroRecords: "Няма намерени резултати",
                        paginate: {
                            first: "Първа",
                            last: "Последна",
                            next: "Следваща",
                            previous: "Предишна"
                        }
                    },
                    columns: [
                        null,
                        null,
                        null,
                        null,
                        null,
                        { visible: false }, // ← hides column 5
                        null
                    ]
                });
                // Find the "Show X entries" container that DataTables created
                const wrapper = table.table().container();
                const lengthDiv = wrapper.querySelector('.dataTables_length');

                if (lengthDiv) {
                    const statusHtml = `
                        <label class="ml-3 mb-0">
                            <span class="mr-1">Статус:</span>
                            <select id="statusFilter"
                                    class="form-control form-control-sm d-inline-block w-auto">
                                <option value="all">Всички</option>
                                <option value="true" selected>Активни</option>
                                <option value="false">Завършили</option>
                            </select>
                        </label>
                    `;
                    lengthDiv.insertAdjacentHTML('beforeend', statusHtml);
                }

                // Filtering
                $('#statusFilter').on('change', function () {
                    const val = this.value;

                    if (val === 'all') {
                        table.column(5).search('').draw();
                    } else if (val === 'true') {
                        table.column(5).search('True').draw();
                    } else {
                        table.column(5).search('False').draw();
                    }
                });

                table.column(5).search('True').draw();
            });
        </script>
}
