@using DesignAndBuilding.Web.ViewModels.Assignment
@using System.Globalization;
@model EngineerAssignmentsViewModel
@{
    int i = 0;
    this.ViewData["Title"] = "Моите наддавания";
}
<div id="alert"></div>
<div id="container">
    <h3 class="text-center">@this.ViewData["Title"]</h3>

    <div class="text-center">
        <br />
        <button class="btn btn-secondary" id="active">Активни задания</button>
        <button class="btn btn-secondary" id="finished">Завършили задания</button>
        <br />
        <br />
    </div>

    <table class="table table-hover text-center" id="active-table">
        <tr class="table-info">
            <th>№</th>
            <th>Име</th>
            <th>Архитект</th>
            <th>Вашата най-добра оферта</th>
            <th>Най-добра оферта</th>
            <th>Оставащо време</th>
            <th></th>
        </tr>
        @foreach (var assignment in Model.ActiveAssignments)
        {
            i++;
            <tr onclick="window.location.href='@Url.Action("details", "assignments", new { id = assignment.Id })'" role="button">
                <td>@i</td>
                <td>@assignment.BuildingName</td>
                <td>арх. @assignment.ArchitectName</td>
                <td>@assignment.UserBestBid</td>
                <td>@assignment.BestBid</td>
                <td>@((assignment.EndDate - DateTime.Now).ToString(@"dd\:hh\:mm\:ss"))</td>
                @if (assignment.BestBid == assignment.UserBestBid)
                {
                    <td>✅</td>
                }
                else
                {
                    <td>❌</td>
                }
            </tr>
        }
    </table>

    <table class="table table-hover text-center invisible" id="finished-table">
        <tr class="table-info">
            <th>№</th>
            <th>Име</th>
            <th>Архитект</th>
            <th>Вашата най-добра оферта</th>
            <th>Най-добра оферта</th>
            <th>Оставащо време</th>
            <th></th>
        </tr>
        @{ i = 0; }
        @foreach (var assignment in Model.FinishedAssignments)
        {
            i++;
            <tr onclick="window.location.href='@Url.Action("details", "assignments", new { id = assignment.Id })'" role="button">
                <td>@i</td>
                <td>@assignment.BuildingName</td>
                <td>арх. @assignment.ArchitectName</td>
                <td>@assignment.UserBestBid</td>
                <td>@assignment.BestBid</td>
                <td>@((assignment.EndDate - DateTime.Now).ToString(@"dd\:hh\:mm\:ss"))</td>
                @if (assignment.BestBid == assignment.UserBestBid)
                {
                    <td>✅</td>
                }
                else
                {
                    <td>❌</td>
                }
            </tr>
        }
    </table>
</div>

@section Scripts
{
    <script>
        $('#finished').on('click', () => {
            let container = document.getElementById('container');
            let active = document.getElementById('active-table');
            let finished = document.getElementById('finished-table');
            container.insertBefore(finished, active);
            finished.classList.remove('invisible');
            active.classList.add('invisible');
        })

        $('#active').on('click', () => {
            let container = document.getElementById('container');
            let active = document.getElementById('active-table');
            let finished = document.getElementById('finished-table');
            container.insertBefore(active, finished);
            active.classList.remove('invisible');
            finished.classList.add('invisible');
        })
    </script>
}
